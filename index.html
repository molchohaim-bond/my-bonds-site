<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>抓 " </title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Assistant', sans-serif; background-color: #f8fafc; }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-5xl mx-auto">
        <div class="text-center mb-10 bg-white p-8 rounded-2xl shadow-sm border border-blue-50">
            <h1 class="text-4xl font-bold text-blue-900 mb-2">抓 "  </h1>
            <p class="text-gray-600">爪转 砖拽注 住住转 AI 注转  拽专</p>
        </div>

        <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100">
            <table class="w-full text-right border-collapse">
                <thead>
                    <tr class="bg-blue-600 text-white">
                        <th class="p-4 font-bold">砖 "</th>
                        <th class="p-4 font-bold">住</th>
                        <th class="p-4 font-bold">转砖 驻</th>
                        <th class="p-4 font-bold">住</th>
                        <th class="p-4 font-bold">转转 AI</th>
                    </tr>
                </thead>
                <tbody id="bonds-table-body">
                    <tr>
                        <td colspan="5" class="p-10 text-center text-gray-500 italic">
                            注 转 住驻转...
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div id="status-msg" class="mt-4 text-center text-sm text-gray-400"></div>
    </div>

    <script>
        // 转专 砖 转 砖转  -Vercel 驻 
        const supabaseUrl = window.location.origin.includes('localhost') ? '' : 'https://nmxpfzjkbdejifddkwtpk.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5teHBmemprYmVqaWZkZGt3dHBrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYwODQwNDAsImV4cCI6MjA4MTY2MDA0MH0.8TaOQDXTDp-wXY5SBhD6yMr_MM6UPkvovoe3q1XzFz0';

        // 转专转
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);

        async function fetchBonds() {
            const tableBody = document.getElementById('bonds-table-body');
            const statusMsg = document.getElementById('status-msg');

            try {
                // 砖转 转 
                const { data, error } = await supabase
                    .from('bonds')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) throw error;

                if (!data || data.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="5" class="p-10 text-center text-red-500 font-bold">
                                锔  住住 转 专拽. 驻注 转 -Agent -GitHub!
                            </td>
                        </tr>`;
                    return;
                }

                // 专拽  注转 注
                tableBody.innerHTML = '';

                // 专拽转 转
                data.forEach(bond => {
                    const row = `
                        <tr class="border-b border-gray-50 hover:bg-blue-50 transition-colors">
                            <td class="p-4 font-bold text-blue-900">${bond.bond_name}</td>
                            <td class="p-4 text-gray-600">${bond.bond_type}</td>
                            <td class="p-4 text-green-600 font-bold text-lg">${bond.yield_percent}%</td>
                            <td class="p-4 italic">${bond.risk_level}</td>
                            <td class="p-4 text-sm text-gray-700 leading-relaxed max-w-xs">${bond.recommendation_reason}</td>
                        </tr>
                    `;
                    tableBody.innerHTML += row;
                });
                
                statusMsg.innerText = `注 专: ${new Date().toLocaleString('he-IL')}`;

            } catch (err) {
                console.error('Error:', err);
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="5" class="p-10 text-center text-red-500">
                            砖 专: ${err.message}
                        </td>
                    </tr>`;
            }
        }

        // 驻注 注转 祝
        fetchBonds();
    </script>
</body>
</html>
